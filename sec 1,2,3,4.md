 - u can use reverse ip website instead of nslookup 
 - ip can hold more than one domain

## havkervdns 

-  this one is use to reverse dns to domains by 
 ```
  prips CIDR | hackervdns -r 8.8.8.8
  ```
## SSL&TLS 
-  use crt.sh to search  

----

ุฃููุงุน ุณุฌูุงุช DNS:

- NS (Nameserver records): ุชุญุชูู ุนูู ุฃุณูุงุก ุงูุฎูุงุฏู ุงูููุซููุฉ ุงูุชู ุชุณุชุถูู ุณุฌูุงุช DNS ููุทุงู ูุนูู.
- A (Host record): ูุญุชูู ุนูู ุนููุงู IPv4 ูุงุณู ูุถูู (ูุซู www.megacorpone.com).
- AAAA (Quad A host record): ูุญุชูู ุนูู ุนููุงู IPv6 ูุงุณู ูุถูู.
- MX (Mail Exchange records): ุชุญุชูู ุนูู ุฃุณูุงุก ุงูุฎูุงุฏู ุงููุณุคููุฉ ุนู ูุนุงูุฌุฉ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูููุทุงูุ ูููู ุฃู ูุญุชูู ุงููุทุงู ุนูู ุณุฌูุงุช MX ูุชุนุฏุฏุฉ.
- PTR (Pointer Records): ุชูุณุชุฎุฏู ูู ููุงุทู ุงูุจุญุซ ุงูุนูุณู ููููููุง ุงูุนุซูุฑ ุนูู ุงูุณุฌูุงุช ุงููุฑุชุจุทุฉ ุจุนููุงู IP.
- CNAME (Canonical Name records): ุชูุณุชุฎุฏู ูุฅูุดุงุก ุฃุณูุงุก ูุณุชุนุงุฑุฉ ูุณุฌูุงุช ุงููุถูู ุงูุฃุฎุฑู.
- TXT (Text records): ุชุญุชูู ุนูู ุจูุงูุงุช ุนุดูุงุฆูุฉ ูุชูุณุชุฎุฏู ูุฃุบุฑุงุถ ูุฎุชููุฉ ูุซู ุงูุชุญูู ูู ููููุฉ ุงููุทุงู ุฒู ุงูููููู ุจุชุงุนุช ุงููููุน .
---
# ุงุณุชุนูุงูุงุช ูุฃูุงูุฑ ูุฑุชุจุทุฉ ุจู DNS

## ุงุณุชุฎุฏุงู nslookup
- ููุณุชุฎุฏู ููุงุณุชุนูุงู ุนู ุฎูุงุฏู DNS ูุงูุญุตูู ุนูู ูุนูููุงุช ุญูู ุฃุณูุงุก ุงููุทุงูุงุช ูุนูุงููู IP.  

**ูุซุงู ุนูู ุชุญุฏูุฏ ุฎุงุฏู DNS ูุชุนุฏุงุฏ ูุนูู:**
```bash
nslookup -type=TXT info.megacorptwo.com 192.168.50.151
```

---

## ุงูุชุนุฏุงุฏ ุงูุฌูุงุนู ูููุทุงูุงุช ุงูููุงุจูุฉ ูู IP
**ุฃูุฑ Bash ููุชุนุฏุงุฏ:**
```bash
for ip in $(seq 200 254); do host 51.222.169.$ip; done | grep -v "not found"
```

- ูุณุชุฎุฏู ูุฐุง ุงูุฃูุฑ ูุชุนุฏุงุฏ ุฃุณูุงุก ุงููุถูููู ุงููุฑุชุจุทุฉ ุจูุทุงู ูู ุนูุงููู IP.  
- ูุน ุงุณุชุจุนุงุฏ ุงููุชุงุฆุฌ ุบูุฑ ุงูููุฌูุฏุฉ.  

---

## ุฃุฏูุงุช ุงูุชุนุฏุงุฏ ุงูุชููุงุฆู ูู DNS

### dnsrecon
- ูุฌุฑู ุชุนุฏุงุฏูุง ููุงุณููุง ูุณุฌูุงุช DNS.  

**ุฃูุซูุฉ ุฃูุงูุฑ:**
```bash
dnsrecon -d megacorpone.com -t std
```

```bash
dnsrecon -d megacorpone.com -D ~/list.txt -t brt
```
----
## namp 


ูู ุญุงูู ุนุงูุฒ ุชุนูู guess for os --> 
```
sudo namp --osscan-guess -O               
```
NSE --> scripts for nmap     ---        ููู ูุงุญุฏ ูููู ุงุณุชุฎุฏุงู ูููู ุชุณุงุนุฏู ุชุฏูุฑ ุนูู ุซุบุฑุงุช 


---

## scan from windows powershell

```
Test-NetConnection -port    + ip 
```
----
# ููุฎุต ุณุฑูุน ุนู NetBIOS

## ูุง ูู NetBIOSุ
**NetBIOS** (Network Basic Input/Output System) ูู ูุงุฌูุฉ ุจุฑูุฌูุฉ ูุจุฑูุชูููู ูุฏูู ูุณูุญ ูุฃุฌูุฒุฉ ุงูุดุจูุฉ ุงููุญููุฉ (LAN) ุจุงูุชูุงุตู ุจุงุณุชุฎุฏุงู **ุฃุณูุงุก ุงูุฃุฌูุฒุฉ** ุจุฏูุงู ูู ุนูุงููู IP. ุงุณุชุฎุฏู ุจูุซุฑุฉ ูู ุจูุฆุงุช Windows ุงููุฏููุฉ.

## ุงููุธุงุฆู ุงูุฃุณุงุณูุฉ
- **Name Service**: ุฑุจุท ุงุณู ุงูุฌูุงุฒ ุจุนููุงูู (ูุซู ุชุณุฌูู ูุงุณุชุนูุงู ุนู ุฃุณูุงุก NetBIOS).  
- **Datagram Service**: ุฅุฑุณุงู ุฑุณุงุฆู ุจูุง ุงุชุตุงู (connectionless) โ ูุดุจู UDP.  
- **Session Service**: ุงุชุตุงูุงุช ููุฌูุฉ (connection-oriented) โ ูุดุจู TCP.

## ุงูุจุฑูุชูููู ูุงูุชุดุบูู
- ุนุงุฏุฉู ูุนูู ููู TCP/IP ูููุนุฑู ุญูููุง ุจุงุณู **NetBIOS over TCP/IP (NBT)**.  
- ุงูููุงูุฐ ุงูุดุงุฆุนุฉ:
  - `137/UDP, TCP` โ NetBIOS Name Service  
  - `138/UDP` โ Datagram Service  
  - `139/TCP` โ Session Service (ูุงู ูุฑุชุจุทูุง ุจู SMBv1)

## ุงูุงุณุชุฎุฏุงูุงุช ุงูุดุงุฆุนุฉ
- ูุดุงุฑูุฉ ุงููููุงุช ูุงูุทุงุจุนุงุช ูู ุดุจูุงุช Windows ุงููุฏููุฉ.  
- ุงูุชุดุงู ุฃุฌูุฒุฉ ุฏุงุฎู ุงูุดุจูุฉ ุงููุญููุฉ.  
- ุฏุนู ุชุทุจููุงุช ูุฏููุฉ ุชุนุชูุฏ ุนูู ุฃุณูุงุก NetBIOS.

## ุงููุฎุงุทุฑ ูุงููููุฏ
- ูุฏูู ูุบูุฑ ุขูู ููุงุฑูุฉ ุจุงูุชูููุงุช ุงูุญุฏูุซุฉ.  
- ูุนุฑุถ ูุนูููุงุช ุนู ุงูุฃุฌูุฒุฉ (ุฃุณูุงุกุ ูุดุงุฑูุงุช) ููุฏ ููุณุชุบู ูู ุงููุฌูุงุช ุงูุงุณุชุทูุงุนูุฉ.  
- ุงุณุชุจุฏู ุชุฏุฑูุฌูุงู ุจู DNS ู Active Directory ููุณุฎ ุฃุญุฏุซ ูู SMB (SMB2/SMB3).

## ุฃุฏูุงุช ุนูููุฉ
- ูู Windows ุงุณุชุฎุฏู:
```bash
nbtstat -A 192.168.1.10
```
```
nbtstat -n 
```
ูุนุฑุถ ุฃุณูุงุก NetBIOS ุงููุณุฌูุฉ ุนูู ุงูุฌูุงุฒ ุฐู ุงูุนููุงู `192.168.1.10`.
	ุชุงูู ุงูุฑ ูุนุฑุถูู ุฌุฏูู NetBIOS Name

## ุงูุฎูุงุตุฉ
NetBIOS ูููุฏ ูููู ุชุฑุงุซ ุดุจูุงุช Windows ูููู ูุงูุช ุงูุฃุฌูุฒุฉ ุชูุชุดู ุจุนุถูุง ุงูุจุนุถุ ููู ูู ุงูุจูุฆุงุช ุงูุญุฏูุซุฉ ูู ุงูุฃูุถู ุงูุงุนุชูุงุฏ ุนูู DNSุ Active Directoryุ ูุจุฑูุชููููุงุช ุฃูุซุฑ ุฃูุงููุง.

# ููุฎุต NetBIOS Name (15 Characters)

- ุงุณู ุงูุฌูุงุฒ ูู **NetBIOS** = 16 ุฎุงูุฉ.  
- **15 ุฎุงูุฉ** ุงูุฃููู โ ุงุณู ุงูุฌูุงุฒ ุงููู ุจููุชุจู ุงููุณุชุฎุฏู.  
- **ุงูุฎุงูุฉ 16** โ suffix ูุญุฏุฏ ููุน ุงูุฎุฏูู ุจุชุทูู ุจ hex

## ุฃูุซูุฉ ุนูู Suffix
| Suffix (Hex) | ุงูุฎุฏูุฉ            |
| ------------ | ----------------- |
| 0x00         | Workstation       |
| 0x20         | Server Service    |
| 0x03         | Messenger Service |

## ุงูุฎูุงุตุฉ
- ูุณููุญ ุจุงุณู ุฌูุงุฒ ุฃูุตุงู **15 ุญุฑู**.  
- ุงูุญุฑู ุงูู16 ูุญุฌูุฒ ูุชุนุฑูู ุงูุฎุฏูุฉ (ูุด ุฌุฒุก ูู ุงูุงุณู).  
- ุฃู ุงุณู ุฃุทูู ูู 15 ุจูุชูุต ุชููุงุฆููุง.

# NetBIOS Datagram Service

## ูุง ููุ
- ุฌุฒุก ูู ุฎุฏูุงุช NetBIOS ุงูุซูุงุซุฉ (Name, Datagram, Session).  
- ูุชูุญ **ุฅุฑุณุงู ุฑุณุงุฆู ุจูุง ุงุชุตุงู (Connectionless)** ุจูู ุงูุฃุฌูุฒุฉ.  
- ูุดุจู ููุฑุฉ **UDP** (ุฅุฑุณุงู ุณุฑูุน ูู ุบูุฑ ูุง ูุนูู ุงุชุตุงู ูุณุชูุฑ).

## ุงูุฎุตุงุฆุต
- ูุณุชุฎุฏู **UDP/138**.  
- ุงูุฑุณุงูุฉ ูููู ุชุชุจุนุช ุฅูู:
  - ุฌูุงุฒ ูุงุญุฏ (Unicast).  
  - ูุฌููุนุฉ ุฃุฌูุฒุฉ (Multicast).  
  - ูู ุงูุฃุฌูุฒุฉ ูู ุงูุดุจูุฉ (Broadcast).  
- ูุง ูุถูู ุงูุชูุตูู (ูููู ุงูุฑุณุงูุฉ ุชุถูุน ุฒู UDP).  

## ุงูุงุณุชุฎุฏุงูุงุช
- ูุดุงุฑูุฉ ุงููููุงุช/ุงูุทุงุจุนุงุช ูู ุดุจูุงุช Windows ุงููุฏููุฉ.  
- ุฅุนูุงูุงุช ุงูุดุจูุฉ (Broadcasts) ูุงูุชุดุงู ุงูุฎุฏูุงุช.  
- ุงูุชูุงุตู ุงูุณุฑูุน ุงููู ูุด ูุญุชุงุฌ ุฌูุณุฉ Session ูุงููุฉ.

## ุงูุฎูุงุตุฉ
- **Datagram Service = NetBIOS + UDP.**  
- ููุงุณุจ ููุฑุณุงุฆู ุงูุณุฑูุนุฉ (ุฒู ุงูุชูุจููุงุช) ููู ุบูุฑ ูุถููู ุงูุชูุตูู.  
- ุฃูู ุฃูุงูุงู ูุญุฏูุซุงู ุชู ุงุณุชุจุฏุงูู ุจุทุฑู ุฃุญุฏุซ (ูุซู SMB over TCP).
# NetBIOS Session Service

## ูุง ููุ
- ุฎุฏูุฉ ูู ุฎุฏูุงุช NetBIOS.  
- ุจุชุณูุญ ุจุฅูุดุงุก **ุฌูุณุฉ ุงุชุตุงู ูุณุชูุฑุฉ** ุจูู ุฌูุงุฒูู ุนูู ุงูุดุจูุฉ.  
- ุงูุฌูุณุฉ ุฏู ุฒู ุฎุท ุชููููู ููุชูุญ ุจูู ุงูุฌูุงุฒูู ุทูู ูุชุฑุฉ ุงูุชูุงุตู.  

## ุงููููุฐ
- ูุดุชุบู ุนูู **TCP/139**.  

## ุทุฑููุฉ ุงูุนูู
1. ุฌูุงุฒ ูุทูุจ ูุชุญ Session ูุน ุฌูุงุฒ ุขุฎุฑ.  
2. ุงูุฌูุงุฒ ุงูุขุฎุฑ ููุงูู ุฃู ูุฑูุถ.  
3. ูู ูุงูู โ ูุชู ุฅูุดุงุก ููุงุฉ ุงุชุตุงู ูุณุชูุฑุฉ.  
4. ุงูุจูุงูุงุช ุชุชููู ูู ุงูุงุชุฌุงููู ุจุดูู ูุฑุชุจ ููุถููู.  
5. ุงูุฌูุณุฉ ุชุณุชูุฑ ูุญุฏ ูุง ูุงุญุฏ ูููู ูููููุง.  

## ุงูุงุณุชุฎุฏุงูุงุช
- ูุงู ุงูุฃุณุงุณ ููุดุงุฑูุฉ ุงููููุงุช ูุงูุทุงุจุนุงุช ุนุจุฑ **SMBv1** ูู ุดุจูุงุช Windows.  
- ุจูุถูู ูุตูู ุงูุจูุงูุงุช ุจุงูุชุฑุชูุจ ุงูุตุญ ููู ุบูุฑ ููุฏุงู.  

## ุงูุฎูุงุตุฉ
- Session Service = ููุงุฉ ุงุชุตุงู ุทูููุฉ ูููุซููุฉ ุจูู ุฌูุงุฒูู.  
- ูู ุงููู ูุงู ุจูููุฑ **ุงูุงุชุตุงู ุงูุฃุณุงุณู ูุดุจูุงุช Windows ุงููุฏููุฉ** ูุจู ูุง SMB ููุชูู ููุจูุฑุช 445.
- ุฎูู ุจุงูู ูู ุงูู SMP ุนุดุงู ูุดุชุบู ูุงุฒู ูููู ุดุบุงู ูุจูู NetBios 
- ูุนูู ูุชูุงูู port 139 ุดุบุงู ูุงุฒู ูุน port 445
# ุฃูุงูุฑ ูููุฉ ูุน nbtstat

## 1. ุนุฑุถ ุฌุฏูู ุงูุฌูุณุงุช (NetBIOS sessions)
```bash
nbtstat -s
```
- ููุถุญ ุงูุงุชุตุงูุงุช (Sessions) ุงูุญุงููุฉ ูุน ุงูุฃุฌูุฒุฉ ุงูุฃุฎุฑู.  

## 2. ุนุฑุถ ุฅุญุตุงุฆูุงุช ุงูุจุฑูุชูููู
```bash
nbtstat -r
```
- ููุถุญ ุนุฏุฏ ุงูุงุณุชุนูุงูุงุช (queries) ุงููู ุงุชุนููุช ุนู ุทุฑูู NetBIOS name resolution.  

## 3. ูุณุญ ุงููุงุด ุงูุฎุงุต ุจุงูุฃุณูุงุก
```bash
nbtstat -R
```
- ููุณุญ ุงูู cache ููุนูุฏ ุชุญูููู ูู ููู LMHOSTS.  

## 4. ุฅุนุงุฏุฉ ุชุญููู ููู LMHOSTS
```bash
nbtstat -RR
```
- ูุจุนุช broadcast ูุชุณุฌูู ูุฅุฒุงูุฉ ุฃุณูุงุก NetBIOS ุซู ูุนูุฏ ุชุญููู LMHOSTS.  

## 5. ุนุฑุถ ุฌุฏูู ุงูุฃุณูุงุก ุงููุญูู
```bash
nbtstat -n
```
- ููุถุญ ุฃุณูุงุก NetBIOS ุงููู ุงูุฌูุงุฒ ูุณุฌููุง ูุญูููุง.  

## 6. ุงุณุชุนูุงู ุนู ุฌูุงุฒ ุจุงุณุชุฎุฏุงู ุนููุงู IP
```bash
nbtstat -A <IP>
```
ูุซุงู:
```bash
nbtstat -A 192.168.1.10
```
- ูุนุฑุถ ุฃุณูุงุก NetBIOS ุงููุณุฌูุฉ ููุฌูุงุฒ ุตุงุญุจ ุงูู IP.  

## 7. ุงุณุชุนูุงู ุนู ุฌูุงุฒ ุจุงุณุชุฎุฏุงู ุงุณู
```bash
nbtstat -a <NAME>
```
ูุซุงู:
```bash
nbtstat -a SERVER1
```
- ููุถุญ ุฃุณูุงุก NetBIOS ุงูุฎุงุตุฉ ุจุงูุฌูุงุฒ ุงููู ุงุณูู SERVER1.  

```
nbtstat -v
```

ุฏุง ุนุดุงู ุชุทูุน ุชูุงุตูู ุงูุชุฑ 



---

## ๐ ุงูุฎูุงุตุฉ
- **-n** โ ุงูุฃุณูุงุก ุงููุญููุฉ.  
- **-A / -a** โ ุงุณุชุนูุงู ุนู ุฌูุงุฒ (IP ุฃู ุงุณู).  
- **-s** โ ุงูุฌูุณุงุช ุงููุดุทุฉ.  
- **-r** โ ุฅุญุตุงุฆูุงุช ุงูุงุณุชุนูุงู.  
- **-R / -RR** โ ุฅุฏุงุฑุฉ ุงููุงุด ูููู LMHOSTS.  

-----
## net 

```
net view   ip     
```
ุฏุง ุจูุนุฑูู ุงู ุงููููุงุช share ุนูู ุฌูุงุฒู 

```
net view K: \\ip\ file  
```
ุนุดุงู ุชูุฏุฑ ุชุฏุฎู ุนูู ุงููููุงุช ุจู 

--------

## null session 

- ูู ุญุงูู ุงูู ุชูุฏุฑ ุนูู ุงููููุงุช ูู ุบูุฑ user & pass
- relay on CIFS (common interface file system) AND SMB 
- ------
# ุดุฑุญ ููุฌุฒ ูู `enum4linux` (ุจุงูุนุฑุจู)

`enum4linux` ุฃุฏุงุฉ ุนูู ูููููุณ ูุฎุตุตุฉ ูุฌูุน ูุนูููุงุช ุนู ุฎูุงุฏู **Windows / SMB / NetBIOS**.  
ูู ูู ุงูุฃุณุงุณ **ุบูุงู (wrapper)** ุจูุฑููุจ ููุดุบูู ุฃุฏูุงุช ุชุงููุฉ ูุซู `rpcclient`ุ `net`ุ `nmblookup` ู` smbclient` ุนุดุงู ูุทูุน ูู ูุนูููุงุช ูุซูุฑุฉ ููููุฏุฉ ุจุณูููุฉ.

### ุชุดุบูู ุณุฑูุน
ูุชุดุบูููุง ุจุจุณุงุทุฉ:
```bash
enum4linux <ุนููุงู_IP_ุงููุฏู>
```

---

## ุฅูู ุงููุนูููุงุช ุงููู ุจุชุฌูุนูุง `enum4linux`ุ ูุดุฑุญ ูู ุจูุฏ ุจุงูุนุฑุจู

- **Target Information (ูุนูููุงุช ุงููุฏู)**  
  ูุนูููุงุช ุฃุณุงุณูุฉ ุนู ุงููุฏู ูุซู ุงูู IPุ ุงูุฃุณูุงุก ุงูุจุฏููุฉุ ูุงูู banners ุงููู ุฑุฌุนุชูุง ุงูุฎุฏูุงุช. ูููุฏุฉ ูุชุญุฏูุฏ ูุธุงู ุงูุชุดุบูู ูุงูุฅุตุฏุงุฑ ุงููุญุชูู.

- **Workgroup / Domain (ูุฌููุนุฉ ุงูุนูู / ุงูุฏูููู)**  
  ุงุณู ูุฌููุนุฉ ุงูุนูู (Workgroup) ุฃู ุงุณู ุงูุฏูููู (Domain) ุงููู ุงูุฌูุงุฒ ุฌุฒุก ูููุง. ุฏู ุจูุฏูู ููุฑุฉ ุนู ุจููุฉ ุงูุดุจูุฉ ููู ูู ุฏูููู ูุฑูุฒู (Active Directory) ููุง ูุง.

- **Domain SID (ูุนุฑูู ุงูุฏูููู)**  
  ุงูู SID ูู ูุนุฑู ูุฑูุฏ ููุฏูููู. ููู ูุฃูู ูุณูุญ ุจุงูุชุนุฑู ุนูู ูุทุงูุงุช ุงูู RID ููุณุชุฎุฏู ูู ุชูููุงุช ูุชูุฏูุฉ ููู enumeration ุฃู ูุฌูุงุช ูุนููุฉ ูุซู RID cycling.

- **OS information (ูุนูููุงุช ูุธุงู ุงูุชุดุบูู)**  
  ุฅุตุฏุงุฑ ูููุน ูุธุงู ุงูุชุดุบูู (ูุซูุงู Windows Server 2008ุ Windows 7...) ุงููู ุจูุธูุฑ ูู ุงูุจุงูุฑ ุฃู ุงูุงุณุชุฌุงุจุฉ. ูุนุฑูุฉ ุงูุฅุตุฏุงุฑ ูููุฉ ูุชุญุฏูุฏ ุฅุฐุง ูุงู ูู ุซุบุฑุงุช ูุนุฑููุฉ.

- **Users (ูุงุฆูุฉ ุงููุณุชุฎุฏููู)**  
  ุฃุณูุงุก ุงููุณุชุฎุฏููู ุงููุณุฌูุฉ ุงููู ุงูุฃุฏุงุฉ ูุฏุฑุช ุชุณุชุฎุฑุฌูุง (ุฃู ุฌุฒุก ูููุง). ุฏู ูููุฉ ููุฌูุงุช ุชุฎููู ูููุงุช ุงููุฑูุฑ ุฃู ูููู ุญุณุงุจุงุช ุงููุธุงู.

- **Share Enumeration (ุชุนุฏุงุฏ ุงููุดุงุฑูุงุช / ุงูู Shares)**  
  ูุงุฆูุฉ ุงูู shares ุงููุชุงุญุฉ ุนูู ุงูุฌูุงุฒ (ูุซู `C$`, `ADMIN$`, ุฃู ูุดุงุฑูุงุช ูุฎุตุตุฉ). ูุชุนุฑู ุฅูู ูููู ุชูุฒูู ุฃู ุชุฑูุนู ููู ูุญููู ุงููุตูู (ูุฑุงุกุฉ/ูุชุงุจุฉ).

- **Password Policy (ุณูุงุณุฉ ูููุงุช ุงููุฑูุฑ)**  
  ุฅุนุฏุงุฏุงุช ุณูุงุณุฉ ูููุงุช ุงููุฑูุฑ ูู ุงูุฏูููู/ุงูุฎุงุฏู: ุงูุญุฏ ุงูุฃุฏูู ููุทููุ ูุชุทูุจุงุช ุงูุชุนููุฏุ ูุฏุฉ ุงูุตูุงุญูุฉ... ูููุฏุฉ ูุชุฎุทูุท ูุฌูุงุช ุงููุงููุณ ุฃู ููุนุฑูุฉ ูุฏู ููุฉ ูููุงุช ุงููุฑูุฑ ุงููุชููุนุฉ.

- **Groups (ุงููุฌููุนุงุช)**  
  ุฃุณูุงุก ุงููุฌููุนุงุช ุงููุญููุฉ ุฃู ุงูุฏูููููุฉ (ูุซู `Administrators`, `Domain Users`). ูุนุฑูุฉ ุนุถููุงุช ุงููุฌููุนุงุช ุชุณุงุนุฏู ุชุนุฑู ููู ููู ุตูุงุญูุงุช ุฅุฏุงุฑูุฉ.

- **Users SID (ูุนุฑููุงุช SID ูููุณุชุฎุฏููู)**  
  ุงูู SID ุงููุฑุชุจุท ุจูู ูุณุชุฎุฏู ุฒู ูุทุงูู ุจุชุฏู ุนูู ุงูู ุชุงุจุน  ู domain ูุนูู ุจูููู ุซุงุจุช ุนูู ูุณุชูู domain  ููู ุงููุฎุชูู ุจูููู RID  โ ูุนูููุงุช ุชูููุฉ ุชููุฏ ูู ุนูููุงุช ุงุณุชุฏูุงููุฉ ูุชูุฏูุฉ ุฃู ุฑุจุท ุญุณุงุจุงุช ูุน ุตูุงุญูุงุช ูุนููุฉ. 

- **Printer info (ูุนูููุงุช ุงูุทุงุจุนุงุช)**  
  ุชูุงุตูู ุนู ุทุงุจุนุงุช ูุดุชุฑูุฉ ุฃู ูุณุฌูุฉ ุนูู ุงูุฎุงุฏู. ุฃุญูุงูุงู ูููู ุชูุงูู ูููุงุช ุญุณุงุณุฉ ุฃู ุทุฑู ุงุณุชุบูุงู ุนุจุฑ ูุดุงุฑูุฉ ุงูุทุงุจุนุฉ.

---

## ููุงุญุธุงุช ุนูููุฉ ููุตุงุฆุญ
- ุฃูุถู ุจุฏุงูุฉ ุณุฑูุนุฉ: ุดุบูู `enum4linux -a <TARGET>` ุนุดุงู ูููุฐ ูู ุงููุญูุต ุงูููุงุณูุฉ ูุฑุฉ ูุงุญุฏุฉ.  
- ูู ุญุตูุช ุนูู ูุชุงุฆุฌ ูุญุฏูุฏุฉุ ุฌุฑูุจ ุชุดุบูููุง ูุน ุตูุงุญูุงุช (credentials) ูุฃู ุงููุชุงูุฌ ุชุชุญุณูู ุฌุฏุงู ูู ุนูุฏู ุญุณุงุจ.  
- ุฏุงูููุง ุงุญูุธ ุงููุงุชุฌ (`| tee file.txt`) ุนุดุงู ุชุฑุฌุน ุชุญูููู ุจุนุฏูู.  
- ุฑุงุนู ุงูููุงููู โ ูููุฐ ุงูุฃุฏุงุฉ ููุท ุนูู ุฃูุธูุฉ ูุตุฑุญ ูู ุจุงุฎุชุจุงุฑูุง.

---

## ุฎูุงุตุฉ
`enum4linux` ุฃุฏุงุฉ ุจุณูุทุฉ ููููุฉ ูุชุฌููุน ูุนูููุงุช Windows/SMB ุจุณุฑุนุฉุ ุงููุชุงูุฌ ุงููู ุจุชุฑุฌุนูุง (shares, users, policy, domain info, SIDs, printers...) ุจุชุนุทูู ูุงุนุฏุฉ ูููุฉ ูุชุฎุทูุท ุฎุทูุงุช ูุฌูู ุฃู ูุญุต ุฃููู ุฃุนูู.
# Rpcclient Tool (Linux)

## Overview
**rpcclient** is a powerful Linux tool that allows executing **Microsoft RPC (Remote Procedure Call)** functions to interact with Windows systems remotely.  
Itโs commonly used in **enumeration and information gathering** during penetration testing.

## Purpose
The tool helps security testers gather valuable details from a **Windows target machine** by communicating over SMB/RPC protocols.

## Usage Syntax
To connect to a remote Windows machine:

```bash
rpcclient -N -U "" <target_IP_address>
```

**Explanation:**
- `-N` โ Prevents rpcclient from asking for a password.  
- `-U ""` โ Sets an empty username (anonymous login).  

Once the connection is successful, the prompt changes to:

```
rpcclient $>
```

From this prompt, you can execute various RPC commands on the target system.

## Help Command
You can list all available commands using:

```bash
rpcclient $> help
```

This displays a **long list of supported operations**, each used to query different system details.

## Example: Enumerating Domain Users
To retrieve the list of users on the remote Windows system:

```bash
rpcclient $> enumdomusers
user:[Administrator] rid: [0x1f4]
user:[eLS] rid: [0x3eb]
user:[Frank] rid: [0x3ed]
user:[Guest] rid: [0x1f5]
user:[HelpAssistant] rid: [0x3e8]
user:[netadmin] rid: [0x3ec]
user:[SUPPORT_388945a0] rid: [0x3ea]
rpcclient $>
```

This command shows all **available accounts** with their **relative identifiers (RIDs)**.

## Autocomplete Feature
`rpcclient` supports **auto-completion**:  
You can type part of a command and press **Tab twice** to display matching options.

Example:

```
rpcclient $> enum
enumalsgroups
enumdata
enumdomains
enumdomgroups
enumdomusers
enumdrivers
...
```

This helps you quickly find valid commands without memorizing them.

## Useful Commands Summary
| Command | Description |
|----------|-------------|
| `enumalsgroups` | Lists all groups. |
| `srvinfo` | Displays server information (OS, build, domain). |
| `lookupnames` | Resolves usernames to their RIDs. |
| `queryuser` | Provides details about a specific user. |
| `enumprivs` | Enumerates user privileges. |

## Key Takeaway
- `rpcclient` is a command-line interface to interact with Windows RPC services from Linux.  
- Itโs mainly used for **enumerating users, groups, privileges, and system info**.  
- Supports **anonymous login**, **autocomplete**, and an **extensive command set**.  
- Itโs an essential tool for **penetration testers** during Windows network enumeration.
# ๐งฉ SNMP (Simple Network Management Protocol)

## 3.3.1 โ What it is (and where it is used)

### ๐น Definition
**SNMP** stands for **Simple Network Management Protocol**.  
Itโs used to **exchange management information** between network devices โ such as routers, switches, servers, and printers.

> ๐ **Example:**  
> SNMP can be used to configure a router, check its uptime, or monitor its performance remotely.

---

## โ๏ธ Structure: Manager and Agents
- SNMP operates using two main entities:
  - **Manager:** usually the **system administrator** who monitors and controls devices.  
  - **Agents:** software running on the devices that send information or receive commands.

- Agents either:
  - Wait for commands from the manager, or  
  - Send **trap messages** (alerts) when something critical happens.

> ๐ง **Ports Used:**
> - UDP **161** โ for general SNMP messages (requests/responses).  
> - UDP **162** โ for **trap** messages (alerts).

> ๐ **Explanation (Arabic):**  
> SNMP ุจูุดุชุบู ุนู ุทุฑูู ุฅู ุงูู โManagerโ ูุจุนุซ ุทูุจ ูุฌูุงุฒ (Agent)ุ ูุงูุฌูุงุฒ ุจูุฑุฏ ุจูุนูููุงุช ุนู ููุณู ุฃู ุจููููุฐ ุฃูุฑุ ุฃู ูุจุนุซ ุชุญุฐูุฑ ููุง ูุญุตู ูุดููุฉ.

---

## ๐ธ SNMP Operations
SNMP works using **four main operations** (similar to HTTP verbs):

| Operation | Function |
|------------|-----------|
| **Get** | Retrieve information from a device. |
| **GetNext** | Retrieve the next variable in the list. |
| **Set** | Modify a configuration or setting on a device. |
| **Trap** | Send alerts from the device to the manager. |

There are also **four command categories:**
1. **Read** โ to monitor device data.  
2. **Write** โ to configure or change device settings.  
3. **Trap** โ to send event alerts to the monitoring system.  
4. **Traversal** โ to check what variables a device supports.

> ๐ **Explanation (Arabic):**  
> SNMP ุจูุณูุญูู ุชูุฑุฃ ูุนูููุงุช ูู ุงูุฃุฌูุฒุฉ (Read)ุ ุฃู ุชุนุฏู ุฅุนุฏุงุฏุงุช (Write)ุ ุฃู ุชุณุชูุจู ุชูุจููุงุช (Trap)ุ ุฃู ุชุนุฑู ุฅูู ุงููุชุบูุฑุงุช ุงููู ุงูุฌูุงุฒ ุจูุฏุนููุง (Traversal).

---

## ๐งฑ SNMP Message Structure
Each SNMP message contains:
- **Header:** includes version number and community string.  
- **PDU (Protocol Data Unit):** the data being transferred.

### ๐ Community Strings
Community strings act like **passwords** for authentication.

| Type | Permission | Description |
|------|-------------|-------------|
| **Public** | Read-only | Allows viewing device data. |
| **Private** | Read/Write | Allows configuration changes. |

> ๐ **Explanation (Arabic):**  
> ุงูู Community String ูู ูููุฉ ูุฑูุฑ ุจุณูุทุฉ:  
> โPublicโ ูููุฑุงุกุฉ ููุทุ ูโPrivateโ ููุชุนุฏูู.  

---

## ๐งพ SNMP Versions
| Version | Security | Notes |
|----------|-----------|-------|
| **SNMPv1** | โ Weak | Uses clear text (no encryption). |
| **SNMPv2** | โ๏ธ Still weak | Slight improvements but insecure. |
| **SNMPv3** | โ Better | Adds encryption and authentication, but still vulnerable to brute-force attacks. |

> ๐ **Explanation (Arabic):**  
> ุงูุฅุตุฏุงุฑ ุงูุซุงูุซ (v3) ูู ุงูุฃูุถู ูุฃูู ุจูุณุชุฎุฏู ุงูุชุดููุฑุ ุจุณ ุจุฑุถู ูููู ูุชูุงุฌู ุจูููุงุช ุณุฑ ุถุนููุฉ.

---

## ๐ณ MIB and OID

### ๐น MIB (Management Information Base)
- MIB is a **database of objects** describing all manageable features of a device (router, switch, etc.).
- Itโs organized in a **tree structure** for easy access.

> ๐ **Explanation (Arabic):**  
> ุงูู MIB ุฒู ูุงุนุฏุฉ ุจูุงูุงุช ูููุง ูู ุงููุชุบูุฑุงุช ุงููู ูููู ูุฏูุฑ ุงูุดุจูุฉ ููุฑุงูุง ุฃู ูุนุฏููุง ูู ุงูุฃุฌูุฒุฉ.
![[Pasted image ูขููขูฅูกููกููขูกูคูขูฅูก.png]]
---

### ๐น OID (Object Identifier)
- Each object in the MIB tree has a **unique ID** called an **OID**.
- The OID represents the โpathโ to that object in the tree.

> ๐ง Example:
> - Most OIDs start with **1.3.6.1**
> - Each leaf in the tree is a property (e.g., uptime, hostname, interface).

Example query:
```
OID: 1.3.6.1.4.1.140.305 (beaDomainList)
```

> ๐ **Explanation (Arabic):**  
> ุงูู OID ูู ุฑูู ูููุฒ ุจูุญุฏุฏ ุนูุตุฑ ูุนูู ุฏุงุฎู ุดุฌุฑุฉ ุงูู MIBุ ููู ุฑูู ุจููุซูู ุฎุงุตูุฉ ูุฎุชููุฉ ูู ุงูุฌูุงุฒ.

---

## ๐งฉ Summary Table

| Concept | Description | Example |
|----------|-------------|----------|
| **Protocol** | SNMP | Simple Network Management Protocol |
| **Ports** | 161 (requests), 162 (traps) | UDP |
| **Manager** | Sends commands and receives traps | Admin System |
| **Agent** | Responds to SNMP commands | Router, Switch |
| **Community Strings** | Public (read), Private (write) | โpublicโ, โprivateโ |
| **Versions** | v1, v2, v3 | v3 = most secure |
| **MIB** | Management Information Base | Database of network variables |
| **OID** | Object Identifier | 1.3.6.1.4.1.140.305 |

---

## ๐ Arabic Summary (ุงูููุฎุต ุจุงูุนุฑุจู)

- ุจุฑูุชูููู **SNMP** ุจููุณุชุฎุฏู ูุฅุฏุงุฑุฉ ููุฑุงูุจุฉ ุฃุฌูุฒุฉ ุงูุดุจูุฉ ุฒู ุงูุฑุงูุชุฑ ูุงูุณููุชุด.  
- ุจูุชูููู ูู **Manager** (ุงููุณุคูู) ู **Agents** (ุงูุฃุฌูุฒุฉ).  
- ุจูุดุชุบู ุนูู **ูููุฐูู UDP 161 ู162**.  
- ููู ุฃูุงูุฑ ุฃุณุงุณูุฉ: **Get**, **Set**, **Trap**, **Traversal**.  
- ุงูู **Community Strings** ูู ูุณููุฉ ุฏุฎูู (Public ูููุฑุงุกุฉุ Private ููุชุนุฏูู).  
- ููู **3 ุฅุตุฏุงุฑุงุช**ุ ุฃุญุฏุซูู SNMPv3 ููู ุชุดููุฑ.  
- ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููู ุจูุนุชูุฏ ุนูููุง ุงุณููุง **MIB** ููู ุนูุตุฑ ูููุง ุจูุชุนุฑูู ุจุฑูู ุงุณูู **OID**.  
- ุงูู OID ุจูุจุฏุฃ ุฏุงูููุง ุจู **1.3.6.1**ุ ูุจููุซู ูุณุงุฑ ุฏุงุฎู ุดุฌุฑุฉ ุจูุงูุงุช ุงูุดุจูุฉ.
# SNMP & Tools (snmpwalk, Nmap) โ Summary

## 3.5.1 โ SNMP Attacks (Brief)
The following attack types target SNMP services:

- **Flooding**  
  A DoS technique that spoofs an SNMP agent and floods the SNMP trap manager with tens of thousands of SNMP traps (50 bytes โ 32 KB), exhausting the manager.

- **Community (Default strings abuse)**  
  Using default community strings (`public` / `private`) to gain privileged access to devices.

- **Brute force**  
  Using automated tools to guess the community string to escalate privileges (from read to write).

> **Arabic note:**  
> ูุฌูุงุช SNMP ุดุงุฆุนุฉ ุจุณุจุจ ุงูู default community strings ูุนุฏู ุงูุชุดููุฑ ูู ุงูุฅุตุฏุงุฑุงุช ุงููุฏููุฉ โ ุงููุฌูุงุช ุชุดูู ุญุฑูุงู ุงูุฎุฏูุฉ (Flooding)ุ ุงุณุชุบูุงู strings ุงูุชุฑุงุถูุฉุ ุฃู ุชุฎููู ูููุงุช ุงููุฌุชูุน.

---

## Using `snmpwalk` (Net-SNMP suite)
**Purpose:** `snmpwalk` uses SNMP GETNEXT requests to enumerate a subtree of the MIB on a target device. If an OID is provided, the subtree under that OID is queried; otherwise it queries the default `SNMPv2-SMI::mib-2` subtree.

**Basic syntax:**
```bash
snmpwalk -v <version> -c <community> <target> [OID]
```

**Example (basic system info):**
```bash
snmpwalk -v 2c -c public 192.168.102.149
```

**Sample output (excerpt):**
```
SNMPv2-MIB::sysDescr.0 = STRING: Hardware: Intel64 Family 6 Model 42 ... - Software: Windows Version 6.1 (Build 7601...)
SNMPv2-MIB::sysObjectID.0 = OID: SNMPv2-SMI::enterprises.311.1.1.3.1.1
DISMAN-EVENT-MIB::sysUpTimeInstance = Timeticks: (872094) 2:25:20.94
SNMPv2-MIB::sysName.0 = STRING: els
```

**Options explained:**
- `-v 2c` โ use SNMP version 2c  
- `-c public` โ community string = `public`

**Query specific installed software (example OID `hrSWInstalledName`):**
```bash
snmpwalk -v 1 -c public 192.168.102.149 hrSWInstalledName
```

**Sample output (software list):**
```
HOST-RESOURCES-MIB::hrSWInstalledName.1 = STRING: "Microsoft Visual Studio 2010 Tools for Office Runtime (x64)"
HOST-RESOURCES-MIB::hrSWInstalledName.2 = STRING: "OpenVPN 2.3.8-1601"
...
HOST-RESOURCES-MIB::hrSWInstalledName.11 = STRING: "Microsoft .NET Framework 4.5.1"
```

> **Arabic note:**  
> `snmpwalk` ูููุฏ ูุงุณุชูุดุงู ูุงูู ุดุฌุฑุฉ MIB ุฃู ูุณู ูุญุฏุฏ ูููุง. ุชุญุฏูุฏ OID ูุณุงุนุฏู ุชุฌูุน ููุท ุงููุชุบูุฑุงุช ุงููู ุชููู (ูุซูุงู ุจุฑุงูุฌ ูุซุจุชุฉุ ูุงุฌูุงุชุ ุฅุนุฏุงุฏุงุช).

---

## IMPORTANT: MIBs show as numeric OIDs?
If `snmpwalk` outputs numeric OIDs like:
```
iso.3.6.1.2.1.1.1.0 = STRING: "Hardware: Intel64..."
```
then install the MIB files to get friendly names:

**On Debian/Ubuntu:**
```bash
sudo apt-get install snmp-mibs-downloader
```

After installing, edit `/etc/snmp/snmp.conf` and comment out the `mibs :` line (remove or comment it):

```text
# mibs :
```

Then rerun your `snmpwalk` to see symbolic MIB names instead of numeric OIDs.

> **Arabic note:**  
> ูู ุธูุฑุช OID ุฃุฑูุงู ูุงุฒู ุชูุฒู ุงูุญุฒู ุงูุฎุงุตุฉ ุจุงูู MIBs ูุชูุนููุง ูู `snmp.conf` ุนุดุงู ุชุญุตู ุนูู ุฃุณูุงุก ูููููุฉ ุจุฏู ุงูุฃุฑูุงู.

---

## Nmap & SNMP NSE scripts
Nmap includes useful NSE scripts for SNMP enumeration. Scripts live in `/usr/share/nmap/scripts` (or similar).

**List SNMP scripts:**
```bash
ls -l /usr/share/nmap/scripts | grep -i snmp
```

**Common SNMP scripts:**
- `snmp-brute` โ brute force SNMP community strings  
- `snmp-info` โ basic SNMP information  
- `snmp-interfaces` โ list device interfaces  
- `snmp-netstat` โ network connections  
- `snmp-processes` โ running processes  
- `snmp-sysdescr` โ system description  
- `snmp-win32-services` โ installed Windows services

**Run a single SNMP script with UDP scan:**
```bash
sudo nmap -sU -p 161 --script=<script_name> <target_IP>
```
**Example:**
```bash
sudo nmap -sU -p 161 --script=snmp-info 192.168.102.149
```

> **Arabic note:**  
> ุงุณุชุฎุฏู `nmap` ูุน ุณูุฑูุจุชุงุช SNMP ููุญุตูู ุนูู ูุนูููุงุช ููููููุฉ ุฃู ูุชุฌุฑุจุฉ ุชุฎููู community strings (ูุน `snmp-brute`). ุฏุงุฆูุงู ุดุบูู ูู root ุฅุฐุง ูุทููุจ ูููุตูู ุฅูู ุญุฒู UDP ูุงููุฉ.

---

## Quick checklist for SNMP enumeration & attacks (pentest flow)
1. **Discover SNMP on target:** `nmap -sU -p 161 --script=snmp-sysdescr <target>`  
2. **Try default community strings:** `snmpwalk -v2c -c public <target>` and `snmpwalk -v2c -c private <target>`  
3. **If community found, enumerate:** `snmpwalk -v2c -c <community> <target> <OID or subtree>`  
4. **Use `snmpwalk` with specific OIDs** (e.g., `hrSWInstalledName`, `sysDescr`) to gather targeted info.  
5. **Use `nmap` SNMP scripts** for automated checks and brute forcing (`snmp-brute`).  
6. **Record findings:** open community strings, sensitive config values, software lists, running services, interfaces.

> **Arabic note:**  
> ุณูุฑ ุงูุนูู: ุงูุชุดุงู ุงูุฎุฏูุฉ โ ุชุฌุฑุจุฉ community ุงูุงูุชุฑุงุถูุฉ โ ุงุณุชุบูุงู ุฃู ูุตูู โ ุฌูุน ุงููุนูููุงุช ุงูุญุณุงุณุฉ (ุจุฑุงูุฌุ ุฎุฏูุงุชุ ูุงุฌูุงุช) โ ุชูุซูู ุงููุชุงุฆุฌ.

---

## Safety & Ethics
- Only perform SNMP enumeration and attacks on systems you own or are explicitly authorized to test.  
- Misuse of these techniques is illegal and unethical.

---

## Useful commands summary (copy/paste)
```bash
# Basic SNMP info
snmpwalk -v 2c -c public 192.168.102.149

# Query installed software
snmpwalk -v 1 -c public 192.168.102.149 hrSWInstalledName

# Install MIBs on Debian/Ubuntu
sudo apt-get install snmp-mibs-downloader
# Then comment out `mibs :` in /etc/snmp/snmp.conf

# Nmap SNMP script example
sudo nmap -sU -p 161 --script=snmp-info 192.168.102.149

# Nmap brute force community strings
sudo nmap -sU -p 161 --script=snmp-brute 192.168.102.149
```

---

## Final short Arabic summary (ูุจุณุท)
- `SNMP` ุจุฑูุชูููู ูุฅุฏุงุฑุฉ ุฃุฌูุฒุฉ ุงูุดุจูุฉุ ูุณุชุฎุฏู Manager โ Agents ุนุจุฑ UDP 161/162.  
- ุฃุฏูุงุช ูููุฉ: `snmpwalk` (ูุชุฌููุน ุดุฌุฑุฉ MIB) ู`nmap` ูุน ุณูุฑูุจุชุงุช SNMP.  
- ูุฌูุงุช ุดุงุฆุนุฉ: Floodingุ ุงุณุชุฎุฏุงู community ุงูุงูุชุฑุงุถูุ brute-force ููู community strings.  
- ุฏุงุฆูุงู ุงุดุชุบู ููุท ุนูู ุฃูุธูุฉ ูุณููุญ ูู ุจุงุฎุชุจุงุฑูุง.

## NMAP 


- ุจุชุชููู ูู ุงุฑุจุน ูุฑุงุญู 
-1 Ping or on ping scan 
-2 port scan 
-3 service scan
-4 version scan 



---
 1. ูุญุต ูุงุฆูุฉ ุงูุฃูุฏุงู ูุญูุธ ุงููุชูุฌุฉ
nmap -iL allsubs.txt -o nmap.txt

2. ูุญุต ูุฏู ูุญุฏุฏ ููุนุฑูุฉ ุงูููุงูุฐ ุงูููุชูุญุฉ ุซู ูุดู ุงูุฅุตุฏุงุฑุงุช
nmap <ip> -sV -p 1-65535 -oA detailed_<ip>

3. ุชุดุบูู ุณูุฑุจุชุงุช ุงููุฆุฉ ุงูููุงุณุจุฉ (ูุซุงู: vuln)
nmap 192.168.1.1 --script=vuln -sV -oN vuln_192.168.1.1.txt

4. ุชุดุบูู ูู ุณูุฑุจุชุงุช SSH ูู ูููุช ุจูุฑุช 22
nmap 192.168.1.1 --script=ssh* -p 22 -oN ssh_scripts_192.168.1.1.txt

5. ุชุฎุทู ping ูุงุฎูุงุก ุจุนุถ ุงูุชูุงุตูู ูู ูุงุฒู
nmap -sS -Pn -n 192.168.1.1 -p 22,80,443 -oN stealth_192.168.1.1.txt

 6. ูุญุงููุฉ ุชุฌุฒุฆุฉ ุงูุญุฒู (ุจุญุฐุฑ)
nmap -f 192.168.1.1 -p 80


--


